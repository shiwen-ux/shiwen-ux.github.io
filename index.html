<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SHIWEN | Creative Developer</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      background: #000;
      color: #fff;
      font-family: 'JetBrains Mono', monospace;
      overflow-x: hidden;
      min-height: 100vh;
    }

    .ascii-background {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 75vh;
      z-index: 0;
      overflow: hidden;
    }

    /* Controls Panel */
    .controls {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 100;
      background: rgba(0, 0, 0, 0.85);
      border: 1px solid #333;
      padding: 20px;
      width: 280px;
      font-size: 11px;
      color: #888;
    }

    .controls.hidden {
      display: none;
    }

    .controls h3 {
      color: #fff;
      font-size: 12px;
      margin-bottom: 20px;
      padding-bottom: 10px;
      border-bottom: 1px solid #333;
      font-weight: 500;
      letter-spacing: 0.1em;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .control-group {
      margin-bottom: 16px;
    }

    .control-group label {
      display: flex;
      justify-content: space-between;
      margin-bottom: 6px;
      color: #888;
    }

    .control-group label span {
      color: #fff;
      font-weight: 500;
    }

    .control-group input[type="range"] {
      width: 100%;
      height: 4px;
      -webkit-appearance: none;
      appearance: none;
      background: #333;
      outline: none;
      cursor: pointer;
    }

    .control-group input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 12px;
      height: 12px;
      background: #fff;
      cursor: pointer;
    }

    .control-group input[type="range"]::-moz-range-thumb {
      width: 12px;
      height: 12px;
      background: #fff;
      cursor: pointer;
      border: none;
    }

    .toggle-controls {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 101;
      background: #000;
      border: 1px solid #333;
      color: #fff;
      padding: 8px 12px;
      font-family: 'JetBrains Mono', monospace;
      font-size: 11px;
      cursor: pointer;
      display: none;
    }

    .controls.hidden + .toggle-controls {
      display: block;
    }

    .btn-toggle {
      background: none;
      border: none;
      color: #888;
      font-family: 'JetBrains Mono', monospace;
      font-size: 14px;
      cursor: pointer;
      padding: 0;
    }

    .btn-toggle:hover {
      color: #fff;
    }

    /* Footer */
    .footer {
      position: fixed;
      bottom: 0;
      left: 0;
      width: 100%;
      height: 25vh;
      background: #000;
      padding: 40px;
      z-index: 10;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      gap: 32px;
    }

    .footer p {
      color: #CCC;
      font-size: 24px;
      letter-spacing: 0.05em;
      text-transform: uppercase;
    }

    .footer p .company {
      color: #CCC;
      cursor: pointer;
      transition: color 0.3s ease;
      text-decoration: underline;
    }

    .footer p .company:hover {
      color: #fff;
    }

    .footer-meta {
      display: flex;
      align-items: center;
      gap: 24px;
      color: #888;
      font-size: 16px;
      letter-spacing: 0.05em;
      line-height: 1;
    }

    .footer-meta span {
      cursor: default;
      display: flex;
      align-items: center;
      color: #888;
    }
  </style>
</head>
<body>
  <canvas class="ascii-background" id="asciiBackground"></canvas>

  <div class="footer">
    <p id="description"><span id="descText">Shiwen is designing AI </span><span id="microsoftBtn" class="company">@Microsoft</span><span id="descText2">, previously </span><span id="mathworksBtn" class="company">@MathWorks</span><span id="descText3">, </span><span id="philipsBtn" class="company">@Philips</span></p>
    <div class="footer-meta">
      <span id="localTime">--:--:-- PST</span>
      <span>¬∑</span>
      <span>Vancouver, BC</span>
      <span>¬∑</span>
      <span id="weather">--¬∞C</span>
    </div>
  </div>

  <div class="controls hidden" id="controls">
    <h3><span>> CONTROLS</span><button class="btn-toggle" id="hideControls">[√ó]</button></h3>
    <div class="control-group">
      <label>Size <span id="fontSizeVal">20px</span></label>
      <input type="range" id="fontSize" min="6" max="30" value="20">
    </div>
    <div class="control-group">
      <label>Trail Length <span id="trailVal">48</span></label>
      <input type="range" id="trailLength" min="5" max="100" value="48">
    </div>
    <div class="control-group">
      <label>Cursor Size <span id="cursorVal">6</span></label>
      <input type="range" id="cursorSize" min="2" max="15" value="6">
    </div>
  </div>
  
  <button class="toggle-controls" id="showControls">[+] CONTROLS</button>

  <script>
    // DOM Elements
    const canvas = document.getElementById('asciiBackground');
    const ctx = canvas.getContext('2d');
    const controls = document.getElementById('controls');
    
    // Settings
    let settings = { fontSize: 20 };
    let cursorRadius = 6;
    let maxTrailLength = 48;
    
    // Grid state
    let gridData = [];
    let gridWidth = 0;
    let gridHeight = 0;
    let mouseX = 0;
    let mouseY = 0;
    let trailPoints = [];
    
    // Logo state
    let activeLogo = null;
    let logoScrambleStart = 0;
    let isScrambling = false;
    const scrambleDuration = 1000;
    const randomChars = 'abcdefghijklmnopqrstuvwxyz0123456789@#$%&*';
    const cursorWord = 'shiwen_';
    
    // Page load scramble effect
    let pageLoadTime = Date.now();
    let isPageLoading = true;
    setTimeout(() => { isPageLoading = false; }, 1000);
    
    const logoWords = {
      microsoft: 'microsoft',
      mathworks: 'mathworks',
      philips: 'philips'
    };
    
    const logoBlockWidth = 12;
    const logoBlockHeight = 6;
    const logoGap = 1;
    
    // MATLAB membrane logo pattern
    const matlabPattern = [
      '                           #%*#             ',
      '                          #+#=+#            ',
      '                         %=%#:-*#           ',
      '                       #%+%%*--+*#          ',
      '                      %%##%#*--=*##         ',
      '                    ##%%*%%#*===*##*        ',
      '                #####%%*%%##*===+*##        ',
      '              +**##%%%*%%%##*+=++*###       ',
      '             =+*##%%%*%%%##**++++**##       ',
      '         +++++=#%%%%*%%%%##**++++**###      ',
      '     ++++++++++++#%*%%%%###**+++++**###     ',
      '+++++++++++++++++#*%%%%####**+++++**###     ',
      '  =+++++++++++++*#%%%%####***+++++***###    ',
      '     +++++++++#+#%%%%####****++++++***###   ',
      '       =++++#=+#%%%#####*****+++++   **###  ',
      '              ##%#####******+++         ##* ',
      '               ####********++             # ',
      '                *+++++++++++                ',
      '                 ----====+                  ',
      '                  :::---                    ',
      '                   :::                      ',
    ];
    
    // Philips wordmark logo pattern
    const philipsPattern = [
      'pppp    pp  pp  pp  pp        pp  pppp     pppp   ',
      'pp pp   pp  pp  pp  pp        pp  pp pp   pp  pp  ',
      'pp  pp  pp  pp  pp  pp        pp  pp  pp  pp      ',
      'pp  pp  pp  pp  pp  pp        pp  pp  pp  pp      ',
      'pppp    pppppp  pp  pp        pp  pppp     pppp   ',
      'pp      pp  pp  pp  pp        pp  pp          pp  ',
      'pp      pp  pp  pp  pp        pp  pp          pp  ',
      'pp      pp  pp  pp  pppppp    pp  pp      pp  pp  ',
      'pp      pp  pp  pp  pppppp    pp  pp       pppp   ',
    ];

    // Get cursor character (cycles through "shiwen_")
    function getCursorChar(index) {
      return cursorWord[index % cursorWord.length];
    }
    
    // Get logo character with scramble effect
    function getLogoChar(logoWord, index) {
      if (!isScrambling) {
        return logoWord[index % logoWord.length];
      }
      const elapsed = Date.now() - logoScrambleStart;
      const progress = Math.min(elapsed / scrambleDuration, 1);
      const charPosition = index % logoWord.length;
      const revealThreshold = progress * logoWord.length;
      
      if (charPosition < revealThreshold) {
        return logoWord[charPosition];
      }
      return randomChars[Math.floor(Math.random() * randomChars.length)];
    }

    // Generate ASCII background
    function generateASCII() {
      const charWidth = settings.fontSize * 0.6;
      const charHeight = settings.fontSize * 1.2;
      // Use floor instead of ceil to avoid partial characters at edges
      gridWidth = Math.floor(canvas.width / charWidth);
      gridHeight = Math.floor(canvas.height / charHeight);
      
      gridData = [];
      let charIndex = 0;
      
      for (let y = 0; y < gridHeight; y++) {
        const row = [];
        for (let x = 0; x < gridWidth; x++) {
          row.push({
            baseChar: '¬∑',
            randomChar: getCursorChar(charIndex++),
            currentChar: null,
            opacity: 0
          });
        }
        gridData.push(row);
      }
    }
    
    // Render grid using Canvas
    function renderGrid() {
      const charWidth = settings.fontSize * 0.6;
      const charHeight = settings.fontSize * 1.2;
      
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      
      // Clip to canvas bounds to prevent overflow
      ctx.save();
      ctx.beginPath();
      ctx.rect(0, 0, canvas.width, canvas.height);
      ctx.clip();
      
      ctx.font = settings.fontSize + 'px "JetBrains Mono", monospace';
      ctx.textAlign = 'center';
      ctx.textBaseline = 'middle';
      
      const totalLogoWidth = logoBlockWidth * 2 + logoGap;
      const totalLogoHeight = logoBlockHeight * 2 + logoGap;
      const logoStartX = Math.floor((gridWidth - totalLogoWidth) / 2);
      const logoStartY = Math.floor((gridHeight - totalLogoHeight) / 2);
      
      const matlabWidth = matlabPattern[0].length;
      const matlabHeight = matlabPattern.length;
      const matlabStartX = Math.floor((gridWidth - matlabWidth) / 2);
      const matlabStartY = Math.floor((gridHeight - matlabHeight) / 2);
      
      const philipsWidth = philipsPattern[0].length;
      const philipsHeight = philipsPattern.length;
      const philipsStartX = Math.floor((gridWidth - philipsWidth) / 2);
      const philipsStartY = Math.floor((gridHeight - philipsHeight) / 2);
      
      let wordIndex = 0;
      
      for (let y = 0; y < gridHeight; y++) {
        for (let x = 0; x < gridWidth; x++) {
          const cell = gridData[y] && gridData[y][x];
          if (!cell) continue;
          
          const px = x * charWidth + charWidth / 2;
          const py = y * charHeight + charHeight / 2;
          
          // Microsoft logo (4 quadrants)
          if (activeLogo === 'microsoft') {
            const logoWord = logoWords.microsoft;
            const inTopLeft = x >= logoStartX && x < logoStartX + logoBlockWidth && 
                              y >= logoStartY && y < logoStartY + logoBlockHeight;
            const inTopRight = x >= logoStartX + logoBlockWidth + logoGap && x < logoStartX + totalLogoWidth && 
                               y >= logoStartY && y < logoStartY + logoBlockHeight;
            const inBottomLeft = x >= logoStartX && x < logoStartX + logoBlockWidth && 
                                 y >= logoStartY + logoBlockHeight + logoGap && y < logoStartY + totalLogoHeight;
            const inBottomRight = x >= logoStartX + logoBlockWidth + logoGap && x < logoStartX + totalLogoWidth && 
                                  y >= logoStartY + logoBlockHeight + logoGap && y < logoStartY + totalLogoHeight;
            
            if (inTopLeft) {
              ctx.fillStyle = '#666';
              ctx.fillText(getLogoChar(logoWord, wordIndex++), px, py);
              continue;
            } else if (inTopRight) {
              ctx.fillStyle = '#888';
              ctx.fillText(getLogoChar(logoWord, wordIndex++), px, py);
              continue;
            } else if (inBottomLeft) {
              ctx.fillStyle = '#AAA';
              ctx.fillText(getLogoChar(logoWord, wordIndex++), px, py);
              continue;
            } else if (inBottomRight) {
              ctx.fillStyle = '#CCC';
              ctx.fillText(getLogoChar(logoWord, wordIndex++), px, py);
              continue;
            }
          } 
          // MathWorks logo
          else if (activeLogo === 'mathworks') {
            const patternY = y - matlabStartY;
            const patternX = x - matlabStartX;
            if (patternY >= 0 && patternY < matlabHeight && patternX >= 0 && patternX < matlabWidth) {
              const patternChar = matlabPattern[patternY][patternX];
              if (patternChar !== ' ') {
                const logoWord = logoWords.mathworks;
                if ('#%*'.includes(patternChar)) {
                  const gradient = patternY / matlabHeight;
                  if (gradient < 0.4) ctx.fillStyle = '#CCC';
                  else if (gradient < 0.6) ctx.fillStyle = '#AAA';
                  else ctx.fillStyle = '#888';
                } else if ('+='.includes(patternChar)) {
                  ctx.fillStyle = '#888';
                } else if ('-:'.includes(patternChar)) {
                  ctx.fillStyle = '#666';
                } else {
                  ctx.fillStyle = '#888';
                }
                ctx.fillText(getLogoChar(logoWord, wordIndex++), px, py);
                continue;
              }
            }
          } 
          // Philips logo
          else if (activeLogo === 'philips') {
            const patternY = y - philipsStartY;
            const patternX = x - philipsStartX;
            if (patternY >= 0 && patternY < philipsHeight && patternX >= 0 && patternX < philipsWidth) {
              const patternChar = philipsPattern[patternY][patternX];
              if (patternChar === 'p') {
                const logoWord = logoWords.philips;
                ctx.fillStyle = '#888';
                ctx.fillText(getLogoChar(logoWord, wordIndex++), px, py);
                continue;
              }
            }
          }
          
          // Trail effect
          if (cell.opacity > 0) {
            ctx.fillStyle = 'rgba(255,255,255,' + cell.opacity.toFixed(2) + ')';
            ctx.fillText(cell.currentChar, px, py);
          } else {
            ctx.fillStyle = '#333';
            ctx.fillText(cell.baseChar, px, py);
          }
        }
      }
      
      ctx.restore(); // Restore clipping
    }

    // Update cursor trail
    function updateTrail() {
      const charWidth = settings.fontSize * 0.6;
      const charHeight = settings.fontSize * 1.2;
      const canvasHeight = window.innerHeight * 0.75;
      const gridX = Math.floor(mouseX / charWidth);
      const gridY = Math.floor(mouseY / charHeight);
      
      // Only add new points if cursor is within the canvas area
      const isInCanvas = mouseY < canvasHeight && gridX >= 0 && gridX < gridWidth && gridY >= 0 && gridY < gridHeight;
      
      if (isInCanvas) {
        trailPoints.unshift({ x: gridX, y: gridY, time: Date.now() });
        if (trailPoints.length > maxTrailLength) {
          trailPoints.pop();
        }
      } else {
        // When cursor is outside canvas, gradually remove trail points to create fade out
        if (trailPoints.length > 0) {
          trailPoints.pop();
        }
      }
      
      // Reset all cells
      for (let y = 0; y < gridHeight; y++) {
        for (let x = 0; x < gridWidth; x++) {
          gridData[y][x].opacity = 0;
        }
      }
      
      // Apply trail effect
      trailPoints.forEach((point, index) => {
        const age = index / maxTrailLength;
        const baseOpacity = 1 - age;
        
        for (let dy = -cursorRadius; dy <= cursorRadius; dy++) {
          for (let dx = -cursorRadius; dx <= cursorRadius; dx++) {
            const px = point.x + dx;
            const py = point.y + dy;
            
            if (px >= 0 && px < gridWidth && py >= 0 && py < gridHeight) {
              const dist = Math.sqrt(dx * dx + dy * dy);
              if (dist <= cursorRadius) {
                const distFactor = 1 - (dist / cursorRadius);
                const opacity = baseOpacity * distFactor * 0.8;
                if (opacity > gridData[py][px].opacity) {
                  gridData[py][px].opacity = opacity;
                  gridData[py][px].currentChar = gridData[py][px].randomChar;
                }
              }
            }
          }
        }
      });
    }

    // Animation loop
    function animate() {
      updateTrail();
      renderGrid();
      requestAnimationFrame(animate);
    }

    // Update background
    function updateBackground() {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight * 0.75;
      generateASCII();
    }

    // Initialize
    updateBackground();
    animate();

    // Throttled mouse move
    let lastMouseUpdate = 0;
    document.addEventListener('mousemove', (e) => {
      const now = Date.now();
      if (now - lastMouseUpdate > 16) { // ~60fps
        mouseX = e.clientX;
        mouseY = e.clientY;
        lastMouseUpdate = now;
      }
    });

    // Debounced resize
    let resizeTimeout;
    window.addEventListener('resize', () => {
      clearTimeout(resizeTimeout);
      resizeTimeout = setTimeout(updateBackground, 100);
    });

    document.getElementById('fontSize').addEventListener('input', (e) => {
      settings.fontSize = parseInt(e.target.value);
      document.getElementById('fontSizeVal').textContent = settings.fontSize + 'px';
      generateASCII();
    });

    document.getElementById('trailLength').addEventListener('input', (e) => {
      maxTrailLength = parseInt(e.target.value);
      document.getElementById('trailVal').textContent = maxTrailLength;
    });

    document.getElementById('cursorSize').addEventListener('input', (e) => {
      cursorRadius = parseInt(e.target.value);
      document.getElementById('cursorVal').textContent = cursorRadius;
    });

    document.getElementById('hideControls').addEventListener('click', () => {
      controls.classList.add('hidden');
    });

    document.getElementById('showControls').addEventListener('click', () => {
      controls.classList.remove('hidden');
    });

    // Logo hover events
    const microsoftBtn = document.getElementById('microsoftBtn');
    const mathworksBtn = document.getElementById('mathworksBtn');
    const philipsBtn = document.getElementById('philipsBtn');
    
    function startLogoHover(logoName) {
      activeLogo = logoName;
      logoScrambleStart = Date.now();
      isScrambling = true;
      setTimeout(() => {
        if (activeLogo === logoName) {
          isScrambling = false;
        }
      }, scrambleDuration);
    }
    
    function endLogoHover() {
      activeLogo = null;
      isScrambling = false;
    }
    
    microsoftBtn.addEventListener('mouseenter', () => startLogoHover('microsoft'));
    microsoftBtn.addEventListener('mouseleave', endLogoHover);
    mathworksBtn.addEventListener('mouseenter', () => startLogoHover('mathworks'));
    mathworksBtn.addEventListener('mouseleave', endLogoHover);
    philipsBtn.addEventListener('mouseenter', () => startLogoHover('philips'));
    philipsBtn.addEventListener('mouseleave', endLogoHover);

    // Local time (Vancouver, BC)
    function updateTime() {
      const now = new Date();
      const timeStr = now.toLocaleTimeString('en-US', {
        timeZone: 'America/Vancouver',
        hour: '2-digit',
        minute: '2-digit',
        second: '2-digit',
        hour12: false
      });
      const tzAbbr = now.toLocaleTimeString('en-US', { 
        timeZone: 'America/Vancouver', 
        timeZoneName: 'short' 
      }).split(' ').pop();
      document.getElementById('localTime').textContent = timeStr + ' ' + tzAbbr;
    }
    updateTime();
    setInterval(updateTime, 1000);

    // Weather (Vancouver, BC)
    async function fetchWeather() {
      try {
        const response = await fetch('https://api.open-meteo.com/v1/forecast?latitude=49.2827&longitude=-123.1207&current=temperature_2m,weather_code');
        const data = await response.json();
        const temp = Math.round(data.current.temperature_2m);
        const code = data.current.weather_code;
        
        let icon = '';
        if (code === 0) icon = '‚òÄÔ∏è';
        else if (code <= 3) icon = '‚õÖ';
        else if (code <= 48) icon = 'üå´Ô∏è';
        else if (code <= 67) icon = 'üåßÔ∏è';
        else if (code <= 77) icon = '‚ùÑÔ∏è';
        else if (code <= 82) icon = 'üåßÔ∏è';
        else if (code <= 86) icon = 'üå®Ô∏è';
        else icon = '‚õàÔ∏è';
        
        document.getElementById('weather').textContent = temp + '¬∞C ' + icon;
      } catch (e) {
        document.getElementById('weather').textContent = '--¬∞C';
      }
    }
    fetchWeather();
    setInterval(fetchWeather, 600000);

    // Description scramble effect on page load
    const descriptionText = 'SHIWEN IS DESIGNING AI @MICROSOFT, PREVIOUSLY @MATHWORKS, @PHILIPS';
    const descriptionEl = document.getElementById('description');
    const originalHTML = descriptionEl.innerHTML;
    
    function scrambleDescription() {
      const elapsed = Date.now() - pageLoadTime;
      const progress = Math.min(elapsed / 1000, 1);
      const revealCount = Math.floor(progress * descriptionText.length);
      
      let scrambledText = '';
      for (let i = 0; i < descriptionText.length; i++) {
        if (descriptionText[i] === ' ') {
          scrambledText += ' ';
        } else if (i < revealCount) {
          scrambledText += descriptionText[i];
        } else {
          scrambledText += randomChars[Math.floor(Math.random() * randomChars.length)].toUpperCase();
        }
      }
      
      descriptionEl.textContent = scrambledText;
      
      if (progress < 1) {
        requestAnimationFrame(scrambleDescription);
      } else {
        // Restore original HTML with interactive spans
        descriptionEl.innerHTML = originalHTML;
        // Re-attach event listeners
        document.getElementById('microsoftBtn').addEventListener('mouseenter', () => startLogoHover('microsoft'));
        document.getElementById('microsoftBtn').addEventListener('mouseleave', endLogoHover);
        document.getElementById('mathworksBtn').addEventListener('mouseenter', () => startLogoHover('mathworks'));
        document.getElementById('mathworksBtn').addEventListener('mouseleave', endLogoHover);
        document.getElementById('philipsBtn').addEventListener('mouseenter', () => startLogoHover('philips'));
        document.getElementById('philipsBtn').addEventListener('mouseleave', endLogoHover);
      }
    }
    scrambleDescription();
  </script>
</body>
</html>

